!function(e,t){for(var n in t)e[n]=t[n]}(exports,function(e){function t(o){if(n[o])return n[o].exports;var s=n[o]={i:o,l:!1,exports:{}};return e[o].call(s.exports,s,s.exports,t),s.l=!0,s.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:o})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(e,t,n){"use strict";let o=n(1);e.exports={fetchHomeFeed:o.fetchHomeFeed,fetchSearchResults:o.fetchSearchResults}},function(e,t,n){"use strict";const o=n(2),s=new(0,n(3).StringDecoder)("utf8");class r{static saveCookiesFromResponse(e,t,n){if(t&&t.headers&&t.headers["set-cookie"])for(let o=0;o<t.headers["set-cookie"].length;o++)n.store(e,t.headers["set-cookie"][o])}static refreshYoutubeDesktopHeaders(e,t){let n=e.PreferencesManager,o=e.cookieManager,i=e.i18n,a=new(0,e.RestClient),c="https://www.youtube.com/feed/purchases?pbjreload=10",u={headers:{"User-Agent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/59.0.3071.115 Safari/537.36","Accept-Language":n.getPreferredLocale()+",en-US;q=0.8,en;q=0.6"}};u.headers.Cookie=o.prepare(c);let l=a.get(c,u,function(e,a){if(e instanceof Buffer&&200===a.statusCode){r.saveCookiesFromResponse(c,a,o);let i=s.write(e),u=null;try{u=/INNERTUBE_CONTEXT_CLIENT_NAME['"]?[\s\n]*?:[\s\n]*?["']?(\d+?)/.exec(i)[1]}catch(e){console.log("Failed to get client name from content "+e)}let l=null;try{l=/INNERTUBE_CONTEXT_CLIENT_VERSION['"]?[\s\n]*?:[\s\n]*?['"]([^'"]+)["']/.exec(i)[1]}catch(e){console.log("Failed to get clientVersion from the content "+e)}let d=null;try{d=/PAGE_CL['"][\s\n]*?:[\s\n]*?(\d+)/.exec(i)[1]}catch(e){console.log("Failed to get pageCl from the content "+e)}let h=null;try{h=/PAGE_BUILD_LABEL['"]?[\s\n]*?:[\s\n]*?['"]([^'"]+)['"]/.exec(i)[1]}catch(e){console.log("Failed to get pageLabel from the contnet"+e)}let m=null;try{m=/VARIANTS_CHECKSUM['"]?[\s\n]*?:[\s\n]*?['"]([^"']+)['"]/.exec(i)[1]}catch(e){console.log("Failed to get variantChecksum from the content "+e)}let p=null;try{"null"===(p=(p=/(?:X-YouTube-Identity-Token|ID_TOKEN)['"]?[\s\n]*?:[\s\n]*?['"]?([^'"},]+)/m.exec(i)[1]).trim())&&(p=null)}catch(e){console.log("Failed to get identityToken from the content "+e)}let b=null;try{b=/[\s\n]*?XSRF_TOKEN[\s\n]*?["'][\s\n]*?:[\s\n]*?["'][\s\n]*?([^"']*?)["']/m.exec(i)[1]}catch(e){console.log("Failed to get sessionToken from the content "+e)}let R={};u&&(R["x-youtube-client-name"]=u),l&&(R["x-youtube-client-version"]=l),p&&(R["x-youtube-identity-token"]=p),d&&(R["x-youtube-page-cl"]=d),h&&(R["x-youtube-page-label"]=h),m&&(R["x-youtube-variants-checksum"]=m),b?n.setYoutubeSessionToken(b):n.setYoutubeSessionToken(null),n.setYoutubeDesktopHeaders(R),t()}else t(i.__("something_went_wrong"))});l.on("requestTimeout",function(e){e.abort()}),l.on("error",function(e){t(i.__("no_internet_error_api_message"))})}static fetchHomeFeed(e,t){let n=e.async,s=e.continuationData,i=e.PreferencesManager,a=e.cookieManager,c=e.RestClient,u=new c,l=e.i18n;n.waterfall([e=>{i.getYoutubeDesktopHeaders()&&0!==Object.keys(i.getYoutubeDesktopHeaders()).length?e():r.refreshYoutubeDesktopHeaders({PreferencesManager:i,cookieManager:a,i18n:l,RestClient:c},t=>{e(t)})},function(e){let t="https://www.youtube.com/?pbj=1",d={headers:{"user-agent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/59.0.3071.115 Safari/537.36","Accept-Language":i.getPreferredLocale()+";en-US;q=0.8,en;q=0.6"}};d.headers=Object.assign({},d.headers,i.getYoutubeDesktopHeaders()),s&&(t="https://www.youtube.com/browse_ajax?ctoken="+s),d.headers.Cookie=a.prepare(t);let h=u.get(t,d,function(s,u){200===u.statusCode&&s?(r.saveCookiesFromResponse(t,u,a),n.waterfall([e=>{"now"===s.refresh?r.refreshYoutubeDesktopHeaders({PreferencesManager:i,cookieManager:a,i18n:l,RestClient:c},t=>{e(t)}):e()},e=>{o.parseHomeFeed({data:s,i18n:l},function(t,n){e(t,n)})}],function(t,n){e(t,n)})):e(l.__("something_went_wrong"))});h.on("requestTimeout",function(e){e.abort()}),h.on("error",function(t){e(l.__("no_internet_error_api_message"))})}],function(e,n){t(e,n)})}static fetchSearchResults(e,t){let n=new(0,e.RestClient),r=e.i18n,i=e.query,a=e.continuationData,c={headers:{}},u="https://m.youtube.com/results";a?(u=a.url,c.headers=a.headers,c.headers.referer="https://m.youtube.com/results?search_query="+encodeURI(i)):i&&(u+="?search_query="+encodeURI(i)),c.headers["User-Agent"]="Mozilla/5.0 (Linux; U; Android 4.4.2; en-us; SCH-I535 Build/KOT49H) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30",c.headers.authority="m.youtube.com";let l=n.get(u,c,function(e,n){if(200===n.statusCode){let n;n="object"!=typeof e?s.write(e):e;let r=o.parseSearchFeed(n,a);t(null,r)}else t(r.__("something_went_wrong"))});l.on("requestTimeout",function(e){e.abort()}),l.on("error",function(e){t(r.__("no_internet_error_api_message"))})}}e.exports=r},function(e,t,n){"use strict";class o{static parseHomeFeed(e,t){let n=e.data,r=e.i18n,i={continuationData:null,sections:[]};try{n.every(function(e,t){return e.response&&e.response.contents&&e.response.contents.twoColumnBrowseResultsRenderer&&e.response.contents.twoColumnBrowseResultsRenderer.tabs&&e.response.contents.twoColumnBrowseResultsRenderer.tabs.length>0&&e.response.contents.twoColumnBrowseResultsRenderer.tabs[0].tabRenderer&&e.response.contents.twoColumnBrowseResultsRenderer.tabs[0].tabRenderer.content&&e.response.contents.twoColumnBrowseResultsRenderer.tabs[0].tabRenderer.content.sectionListRenderer&&e.response.contents.twoColumnBrowseResultsRenderer.tabs[0].tabRenderer.content.sectionListRenderer.continuations&&e.response.contents.twoColumnBrowseResultsRenderer.tabs[0].tabRenderer.content.sectionListRenderer.continuations.length>0&&e.response.contents.twoColumnBrowseResultsRenderer.tabs[0].tabRenderer.content.sectionListRenderer.continuations[0]&&e.response.contents.twoColumnBrowseResultsRenderer.tabs[0].tabRenderer.content.sectionListRenderer.continuations[0].nextContinuationData&&e.response.contents.twoColumnBrowseResultsRenderer.tabs[0].tabRenderer.content.sectionListRenderer.continuations[0].nextContinuationData.continuation?(i.continuationData=e.response.contents.twoColumnBrowseResultsRenderer.tabs[0].tabRenderer.content.sectionListRenderer.continuations[0].nextContinuationData.continuation,!1):!(e.response&&e.response.continuationContents&&e.response.continuationContents.sectionListContinuation&&e.response.continuationContents.sectionListContinuation.continuations&&e.response.continuationContents.sectionListContinuation.continuations.length>0&&e.response.continuationContents.sectionListContinuation.continuations[0].nextContinuationData&&e.response.continuationContents.sectionListContinuation.continuations[0].nextContinuationData.continuation)||(i.continuationData=e.response.continuationContents.sectionListContinuation.continuations[0].nextContinuationData.continuation,!1)}),n.every(function(e,t){let n;return e.response&&e.response.contents&&e.response.contents.twoColumnBrowseResultsRenderer&&e.response.contents.twoColumnBrowseResultsRenderer.tabs&&e.response.contents.twoColumnBrowseResultsRenderer.tabs.length>0&&e.response.contents.twoColumnBrowseResultsRenderer.tabs[0].tabRenderer&&e.response.contents.twoColumnBrowseResultsRenderer.tabs[0].tabRenderer.content&&e.response.contents.twoColumnBrowseResultsRenderer.tabs[0].tabRenderer.content.sectionListRenderer&&e.response.contents.twoColumnBrowseResultsRenderer.tabs[0].tabRenderer.content.sectionListRenderer.contents&&e.response.contents.twoColumnBrowseResultsRenderer.tabs[0].tabRenderer.content.sectionListRenderer.contents.length>0&&(n=e.response.contents.twoColumnBrowseResultsRenderer.tabs[0].tabRenderer.content.sectionListRenderer.contents),n||e.response&&e.response.continuationContents&&e.response.continuationContents.sectionListContinuation&&e.response.continuationContents.sectionListContinuation.contents&&e.response.continuationContents.sectionListContinuation.contents.length>0&&(n=e.response.continuationContents.sectionListContinuation.contents),!n||(n.forEach(function(e){if(e.itemSectionRenderer&&e.itemSectionRenderer.contents&&e.itemSectionRenderer.contents.length>0&&e.itemSectionRenderer.contents[0].shelfRenderer){e=e.itemSectionRenderer.contents[0].shelfRenderer;let t={header:{},content:[]};try{e.title&&e.title.simpleText&&(t.header.title=e.title.simpleText);try{e.endpoint&&e.endpoint&&e.endpoint.commandMetadata&&e.endpoint.commandMetadata.webCommandMetadata&&e.endpoint.commandMetadata.webCommandMetadata.url&&(t.header.url=s.fixUrl(e.endpoint.commandMetadata.webCommandMetadata.url))}catch(e){}try{t.header.thumbnail=e.thumbnail.thumbnails[0].url,t.header.thumbnail=s.fixUrl(t.header.thumbnail)}catch(e){}e.content&&e.content.horizontalListRenderer&&e.content.horizontalListRenderer.items&&e.content.horizontalListRenderer.items.length>0&&e.content.horizontalListRenderer.items.forEach(function(e){if(e.gridVideoRenderer){e=e.gridVideoRenderer;try{let n={isLive:!1};e.videoId&&(n.id=e.videoId,n.webpage_url="http://www.youtube.com/watch?v="+n.id),e.title&&e.title.simpleText&&(n.title=e.title.simpleText),e.publishedTimeText&&e.publishedTimeText&&e.publishedTimeText.simpleText&&(n.releasedDate=e.publishedTimeText.simpleText),e.viewCountText&&e.viewCountText.simpleText&&(n.view_count=e.viewCountText.simpleText);try{n.thumbnail=e.thumbnail.thumbnails[0].url,n.thumbnail=s.fixUrl(n.thumbnail)}catch(e){}e.shortBylineText&&e.shortBylineText.runs&&e.shortBylineText.runs.length>0&&(n.uploader=e.shortBylineText.runs[0].text),e.thumbnailOverlays&&e.thumbnailOverlays.length>0&&e.thumbnailOverlays.every(function(e,t){e.thumbnailOverlayTimeStatusRenderer&&(e.thumbnailOverlayTimeStatusRenderer.text&&e.thumbnailOverlayTimeStatusRenderer.text.simpleText&&(n.duration=e.thumbnailOverlayTimeStatusRenderer.text.simpleText),e.thumbnailOverlayTimeStatusRenderer.style&&"LIVE"===e.thumbnailOverlayTimeStatusRenderer.style.toUpperCase()&&(n.isLive=!0))});try{e.richThumbnail&&e.richThumbnail.movingThumbnailRenderer&&e.richThumbnail.movingThumbnailRenderer.movingThumbnailDetails.thumbnails&&e.richThumbnail.movingThumbnailRenderer.movingThumbnailDetails.thumbnails.length>0&&(n.preview=e.richThumbnail.movingThumbnailRenderer.movingThumbnailDetails.thumbnails[0].url,n.preview=s.fixUrl(n.preview))}catch(e){}t.content.push(n)}catch(e){}}}),t.content&&t.content.length>0&&i.sections.push(t)}catch(e){}}}),!1)}),i.sections=o.shuffle(i.sections),t(null,i)}catch(e){t(r.__("something_went_wrong"))}}static shuffle(e){let t,n,o=e.length;for(;0!==o;)n=Math.floor(Math.random()*o),t=e[o-=1],e[o]=e[n],e[n]=t;return e}static parseSearchFeed(e,t){let n,o=new class{constructor(){this.mediaList=[],this.continuationData=null}};if(t){let s=(n=e).response.continuationContents.itemSectionContinuation.continuations[0].nextContinuationData.continuation;o.continuationData={headers:t.headers,url:"https://m.youtube.com/results?pbj=1&ctoken="+s}}else{let t=function(e){let t={},n=/INNERTUBE_CONTEXT_CLIENT_NAME['"]?[\s\n]*?:[\s\n]*?["']?(\d+?)/.exec(e);2===n.length&&(t["x-youtube-client-name"]=n[1]);let o=/INNERTUBE_CONTEXT_CLIENT_VERSION['"]?[\s\n]*?:[\s\n]*?['"]([^'"]+)["']/.exec(e);2===o.length&&(t["x-youtube-client-version"]=o[1]);let s=/PAGE_CL['"][\s\n]*?:[\s\n]*?(\d+)/.exec(e);2===s.length&&(t["x-youtube-page-cl"]=s[1]);let r=/PAGE_BUILD_LABEL['"]?[\s\n]*?:[\s\n]*?['"]([^'"]+)['"]/.exec(e);2===r.length&&(t["x-youtube-page-label"]=r[1]);let i=/VARIANTS_CHECKSUM['"]?[\s\n]*?:[\s\n]*?['"]([^"']+)['"]/.exec(e);return 2===i.length&&(t["x-youtube-variants-checksum"]=i[1]),t}(e),s=/<div id=['"]initial\-data['"]><!-- ({.*}) -->/.exec(e);if(s&&2===s.length)try{n=JSON.parse(s[1])}catch(e){}let r="";try{r="https://m.youtube.com/results?pbj=1&ctoken="+n.contents.sectionListRenderer.contents[0].itemSectionRenderer.continuations[0].nextContinuationData.continuation}catch(e){}o.continuationData={headers:t,url:r}}try{let e=[];e=t?n.response.continuationContents.itemSectionContinuation.contents:n.contents.sectionListRenderer.contents[0].itemSectionRenderer.contents;for(let t=0;t<e.length;t++){let n=e[t];if(n.compactVideoRenderer){n=n.compactVideoRenderer;try{let e={};e.type="media",e.id=n.videoId,e.webpage_url="http://www.youtube.com/watch?v="+e.id;try{e.view_count=n.viewCountText.runs[0].text}catch(e){}try{e.uploader=this.safeDecodeURI(n.longBylineText.runs[0].text)}catch(e){}try{e.duration=n.lengthText.runs[0].text}catch(e){}e.thumbnail="https://i.ytimg.com/vi/"+n.videoId+"/mqdefault.jpg",e.title=this.safeDecodeURI(n.title.runs[0].text),e.id&&o.mediaList.push(e)}catch(e){console.log(e)}}}}catch(e){}return o}static safeDecodeURI(e){try{return decodeURI(e)}catch(t){return e}}}class s{static fixUrl(e){return e&&(e.startsWith("http")||(e.startsWith("//")?e="https:"+e:e.includes("youtube.com")||(e="https://www.youtube.com"+e))),e}}e.exports=o},function(e,t){e.exports=require("string_decoder")}]));